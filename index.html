<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        .weather-container { max-width: 600px; margin: auto; padding: 20px; border: 1px solid #ddd; border-radius: 10px; }
        .section { margin-top: 10px; padding: 10px; border-bottom: 1px solid #ddd; }
        .forecast { display: flex; flex-wrap: wrap; justify-content: center; margin-top: 20px; }
        .forecast-item { padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin: 5px; text-align: center; width: 120px; }
    </style>
</head>
<body>

    <div class="weather-container">
        <h1>–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã</h1>

        <label for="city">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥:</label>
        <select id="city">
            <option value="Moscow,ru">–ú–æ—Å–∫–≤–∞</option>
            <option value="Saint Petersburg,ru">–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
            <option value="Yekaterinburg,ru">–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥</option>
            <option value="Novosibirsk,ru">–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫</option>
            <option value="Vladivostok,ru">–í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫</option>
        </select>

        <div class="section">
            <h2>–¢–µ–∫—É—â–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</h2>
            <p id="temperature"></p>
            <p id="feels_like"></p>
        </div>

        <div class="section">
            <h2>–û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</h2>
            <p id="description"></p>
            <p><img id="icon" src="" alt=""></p>
        </div>

        <div class="section">
            <h2>–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–µ —É—Å–ª–æ–≤–∏—è</h2>
            <p><b>–î–∞–≤–ª–µ–Ω–∏–µ:</b> <span id="pressure"></span> hPa</p>
            <p><b>–í–ª–∞–∂–Ω–æ—Å—Ç—å:</b> <span id="humidity"></span>%</p>
            <p><b>–û–±–ª–∞—á–Ω–æ—Å—Ç—å:</b> <span id="clouds"></span>%</p>
            <p><b>–í–∏–¥–∏–º–æ—Å—Ç—å:</b> <span id="visibility"></span> –º</p>
        </div>

        <div class="section">
            <h2>–í–µ—Ç–µ—Ä</h2>
            <p><b>–°–∫–æ—Ä–æ—Å—Ç—å:</b> <span id="wind_speed"></span> –º/—Å</p>
            <p><b>–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</b> <span id="wind_direction"></span></p>
            <p><b>–ü–æ—Ä—ã–≤—ã –≤–µ—Ç—Ä–∞:</b> <span id="wind_gust"></span> –º/—Å</p>
        </div>

        <div class="section">
            <h2>–û—Å–∞–¥–∫–∏</h2>
            <p><b>–î–æ–∂–¥—å:</b> <span id="rain"></span> –º–º</p>
            <p><b>–°–Ω–µ–≥:</b> <span id="snow"></span> –º–º</p>
        </div>

        <div class="section">
            <h2>–°–æ–ª–Ω—Ü–µ</h2>
            <p><b>–í–æ—Å—Ö–æ–¥:</b> <span id="sunrise"></span></p>
            <p><b>–ó–∞–∫–∞—Ç:</b> <span id="sunset"></span></p>
        </div>

        <h3>–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 5 –¥–Ω–µ–π (–∫–∞–∂–¥—ã–µ 3 —á–∞—Å–∞)</h3>
        <div class="forecast" id="forecast"></div>
    </div>

    <script>
        const API_KEY = "c2a4d3b120ba309a9bf7a6ba07f02ca4";
        const citySelect = document.getElementById("city");

        function getWindDirection(deg) {
            const directions = ["–°", "–°–í", "–í", "–Æ–í", "–Æ", "–Æ–ó", "–ó", "–°–ó"];
            return directions[Math.round(deg / 45) % 8] + ` (${deg}¬∞)`;
        }

        function formatTime(timestamp) {
            const date = new Date(timestamp * 1000);
            return date.toLocaleTimeString("ru-RU", { hour: "2-digit", minute: "2-digit" });
        }

        async function fetchWeather(city) {
            const API_URL = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&units=metric&lang=ru&appid=${API_KEY}`;

            try {
                const response = await fetch(API_URL);
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ HTTP: ${response.status}`);
                }
                const data = await response.json();
                const currentWeather = data.list[0];

                document.getElementById("temperature").textContent = `üå° ${Math.round(currentWeather.main.temp)}¬∞C`;
                document.getElementById("feels_like").textContent = `ü§î –û—â—É—â–∞–µ—Ç—Å—è –∫–∞–∫: ${Math.round(currentWeather.main.feels_like)}¬∞C`;
                document.getElementById("description").textContent = currentWeather.weather[0].description;
                document.getElementById("icon").src = `https://openweathermap.org/img/wn/${currentWeather.weather[0].icon}.png`;

                document.getElementById("pressure").textContent = currentWeather.main.pressure;
                document.getElementById("humidity").textContent = currentWeather.main.humidity;
                document.getElementById("clouds").textContent = currentWeather.clouds.all;
                document.getElementById("visibility").textContent = currentWeather.visibility;

                document.getElementById("wind_speed").textContent = currentWeather.wind.speed;
                document.getElementById("wind_direction").textContent = getWindDirection(currentWeather.wind.deg);
                document.getElementById("wind_gust").textContent = currentWeather.wind.gust ? currentWeather.wind.gust : "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö";

                document.getElementById("rain").textContent = currentWeather.rain ? currentWeather.rain["3h"] : "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö";
                document.getElementById("snow").textContent = currentWeather.snow ? currentWeather.snow["3h"] : "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö";

                document.getElementById("sunrise").textContent = formatTime(data.city.sunrise);
                document.getElementById("sunset").textContent = formatTime(data.city.sunset);

                const forecastContainer = document.getElementById("forecast");
                forecastContainer.innerHTML = "";
                data.list.forEach(item => {
                    const date = new Date(item.dt * 1000);
                    const formattedDate = date.toLocaleDateString('ru-RU', { weekday: 'short', hour: '2-digit', minute: '2-digit' });

                    const forecastItem = document.createElement("div");
                    forecastItem.classList.add("forecast-item");
                    forecastItem.innerHTML = `
                        <p><b>${formattedDate}</b></p>
                        <p>${Math.round(item.main.temp)}¬∞C</p>
                        <p>üí® ${item.wind.speed} –º/—Å (${getWindDirection(item.wind.deg)})</p>
                        <img src="https://openweathermap.org/img/wn/${item.weather[0].icon}.png" alt="">
                    `;
                    forecastContainer.appendChild(forecastItem);
                });

            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:", error);
                alert(`–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }

        citySelect.addEventListener("change", function () {
            fetchWeather(this.value);
        });

        fetchWeather(citySelect.value);
    </script>

</body>
</html>

